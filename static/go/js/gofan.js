var URL_BECOME_FAN="/ajax/becomeFan";var URL_GET_FANS="/ajax/getFans";var URL_GET_FRIENDS="/ajax/getFriends";var URL_GET_IDOLS="/ajax/getIdols";var URL_GET_COMMENTS="/ajax/getComments";var URL_GET_USERFEED="/ajax/getUserFeed";var URL_ADD_FRIEND="/meeboajax/addfriend";var URL_REMOVE_FRIEND="/meeboajax/removefriend";function becomeFan(B,C,A,E,D){showPleaseWait("Become a Fan","200");pageTracker._trackPageview("/pageTracker/ajax/becomeFan/"+B+"/"+C);if(typeof B!="undefined"&&typeof C!="undefined"){new Ajax.Request(URL_BECOME_FAN+"/"+B+"/"+C,{method:"post",onSuccess:function(G){var F=G.responseText;becomeFanComplete(F,A,E,D)},onFailure:function(){displayFeedback("1Error contacting the server");hidePleaseWait()}})}}function becomeFanComplete(C,J,B,F){parseResponse(C);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){hidePleaseWait();displayFeedback(responseArray.code+GT.gettext("You are now a fan of this animator"));var D=J.split(":");if(D.length>1){for(i=1;i<D.length;i++){$(D[i]).style.display="block"}}$(D[0]).style.display="none";if(typeof isFriendBool!="undefined"&&isFriendBool){$("removefriend").style.display="block"}else{$("addfriend").style.display="block"}if(typeof B!="undefined"&&$(B)!=null&&typeof $(B).className!="undefined"){var A=$(B).innerHTML;var I=A.indexOf("Fans (");var G=A.substring(0,I+6);var E=A.lastIndexOf(")");var H=A.substring(I+6,E);if($(B).className=="tabactive"){if(typeof F!="undefined"&&$(F)!=null){if(H=="0"){$(F).innerHTML=responseArray.html}else{$(F).innerHTML+=responseArray.html}}}H++;var K=A.substr(E);$(B).innerHTML=G+H+K}jQuery(document).trigger("ga.user.becomefan")}else{if(responseArray.code=="1"){hidePleaseWait();displayFeedback(responseArray.code+GT.gettext("Error occurred, please try again later."))}else{hidePleaseWait();displayFeedback(responseArray.code+responseArray.json.error)}}}resetResponse()}function becomeFan2(B,C,A,E,D){showPleaseWait("Become a Fan","200");pageTracker._trackPageview("/pageTracker/ajax/becomeFan/"+B+"/"+C);if(typeof B!="undefined"&&typeof C!="undefined"){new Ajax.Request(URL_BECOME_FAN+"/"+B+"/"+C,{method:"post",onSuccess:function(G){var F=G.responseText;becomeFanComplete2(F,A,E,D)},onFailure:function(){displayFeedback("1Error contacting the server");hidePleaseWait()}})}}function becomeFanComplete2(C,J,B,F){parseResponse(C);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"You are now a fan of this animator");var D=J.split(":");if(D.length>1){for(i=1;i<D.length;i++){$(D[i]).style.display="block"}}$(D[0]).style.display="none";if(typeof B!="undefined"&&$(B)!=null&&typeof $(B).className!="undefined"){var A=$(B).innerHTML;var I=A.indexOf("Fans (");var G=A.substring(0,I+6);var E=A.lastIndexOf(")");var H=A.substring(I+6,E);if($(B).className=="tabblueactive"){if(typeof F!="undefined"&&$(F)!=null){if(H=="0"){$(F).innerHTML=responseArray.html}else{$(F).innerHTML+=responseArray.html}}}H++;var K=A.substr(E);$(B).innerHTML=G+H+K}}else{if(responseArray.code=="1"){displayFeedback(responseArray.code+"Error occurred, please try again later.")}else{displayFeedback(responseArray.code+responseArray.json.error)}}}hidePleaseWait();resetResponse()}function addFriend(A,D,C,B){showPleaseWait("Add Friend","200");pageTracker._trackPageview("/pageTracker/ajax/addFriend/"+A+"/"+D);B=(typeof B!="undefined")?B:"0";if(typeof A!="undefined"&&typeof D!="undefined"){new Ajax.Request(URL_ADD_FRIEND+"/"+D+"/"+B,{method:"post",onSuccess:function(F){var E=F.responseText;addFriendComplete(E,C)},onFailure:function(){displayFeedback("1Error contacting the server");hidePleaseWait()}})}}function addFriendComplete(A,B){parseResponse(A);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){if(typeof B=="undefined"){displayFeedback(responseArray.code+GT.gettext("You are now a friend of this animator<br/>Now if this user adds you as friend, you will be able to see each<br/>other online and chat using the bar at the bottom of your screen"));$("addfriend").style.display="none";$("removefriend").style.display="block"}else{$(B).innerHTML=GT.gettext("Accepted")}}else{if(responseArray.code=="1"){displayFeedback(responseArray.code+GT.gettext("Error occurred, please try again later."))}else{displayFeedback(responseArray.code+responseArray.json.error)}}}hidePleaseWait();resetResponse()}function removeFriend(A,B){showPleaseWait("Remove Friend","200");pageTracker._trackPageview("/pageTracker/ajax/removeFriend/"+A+"/"+B);if(typeof A!="undefined"&&typeof B!="undefined"){new Ajax.Request(URL_REMOVE_FRIEND+"/"+B,{method:"post",onSuccess:function(D){var C=D.responseText;removeFriendComplete(C)},onFailure:function(){displayFeedback("1Error contacting the server");hidePleaseWait()}})}}function removeFriendComplete(A){parseResponse(A);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+GT.gettext("You are no longer a friend of this animator"));$("removefriend").style.display="none";$("addfriend").style.display="block"}else{if(responseArray.code=="1"){displayFeedback(responseArray.code+GT.gettext("Error occurred, please try again later."))}else{displayFeedback(responseArray.code+responseArray.json.error)}}}hidePleaseWait();resetResponse()}function loadFansOrIdols(D){var E=D.split(",");var C=E[0];var G=E[1];var I=E[2];var F=E[3];var H=E[4];var J=E[5];var B=E[6];var K=E[7];var A;switch(I){case"fan":A=URL_GET_FANS+"/"+G+"/"+F+"/"+H;break;case"idol":A=URL_GET_IDOLS+"/"+G+"/"+F+"/"+H;break}new Ajax.Request(A,{method:"post",onSuccess:function(M){var L=M.responseText;fanPagingComplete(L,C,H,J,B,K,G,I,F)},onFailure:function(){displayFeedback("1Error contacting the server")}})}function fanPagingComplete(D,A,G,I,B,J,E,H,C,F){parseResponse(D);if(responseArray.code=="0"){$(A).innerHTML=responseArray.html;$(I).innerHTML=G;if(typeof E!="undefined"&&typeof H!="undefined"&&typeof C!="undefined"){if(F!=undefined){$(B).innerHTML="<a href=\"javascript:loadAnotherPage('"+A+"','"+E+"','"+H+"',"+C+",'"+I+"','"+B+"','"+J+"','prev', '"+F+"');\">"+GT.gettext("Previous")+"</a>";$(J).innerHTML="<a href=\"javascript:loadAnotherPage('"+A+"','"+E+"','"+H+"',"+C+",'"+I+"','"+B+"','"+J+"','next', '"+F+"');\">"+GT.gettext("Next")+"</a>"}else{$(B).innerHTML="<a href=\"javascript:loadAnotherPage('"+A+"','"+E+"','"+H+"',"+C+",'"+I+"','"+B+"','"+J+"','prev');\">"+GT.gettext("Previous")+"</a>";$(J).innerHTML="<a href=\"javascript:loadAnotherPage('"+A+"','"+E+"','"+H+"',"+C+",'"+I+"','"+B+"','"+J+"','next');\">"+GT.gettext("Next")+"</a>"}}if(G<=0){$(B).style.display="none"}else{$(B).style.display="block"}if(responseArray.json.next_page==0){$(J).style.display="none"}else{$(J).style.display="block"}if(H=="userfeed-owner"||H=="userfeed-others"){uploadFeedBlock("feedsmain");if(H=="userfeed-owner"){if(F==undefined||F=="all"){$("idolanilink").hide();$("idolfeedlink").show()}else{$("idolfeedlink").hide();$("idolanilink").show()}}else{if(F==undefined||F=="all"){$("myanilink").hide();$("myfeedlink").show()}else{$("myfeedlink").hide();$("myanilink").show()}}}}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()}function loadAnotherPage(B,F,I,E,J,C,K,D,G){var H=$(J).innerHTML-0;if(D=="next"){H=H+1}else{if(D=="prev"){H=H-1}}var A;switch(I){case"fan":A=URL_GET_FANS+"/"+F+"/"+E+"/"+H+"/"+G;break;case"friend":A=URL_GET_FRIENDS+"/"+F+"/"+E+"/"+H+"/"+G;break;case"idol":A=URL_GET_IDOLS+"/"+F+"/"+E+"/"+H+"/"+G;break;case"usercomment":A=URL_GET_COMMENTS+"/user/"+F+"/"+E+"/"+H;break;case"moviecomment":A=URL_GET_COMMENTS+"/movie/"+F+"/"+E+"/"+H;break;case"userfeed-owner":if(G==undefined){A=URL_GET_USERFEED+"/"+F+"/owner/"+E+"/"+H+"/all/0"}else{A=URL_GET_USERFEED+"/"+F+"/owner/"+E+"/"+H+"/"+G+"/0"}B="feedsmain";break;case"userfeed-others":if(G==undefined){A=URL_GET_USERFEED+"/"+F+"/others/"+E+"/"+H+"/all/0"}else{A=URL_GET_USERFEED+"/"+F+"/others/"+E+"/"+H+"/"+G+"/0"}B="feedsmain";break}new Ajax.Request(A,{method:"post",onSuccess:function(M){var L=M.responseText;fanPagingComplete(L,B,H,J,C,K,F,I,undefined,G)},onFailure:function(){displayFeedback("1Error contacting the server")}})}function loadMyOrIdolsFeeds(D,J){var E=D.split(",");var C=E[0];var G=E[1];var M=E[2];var F=E[3];var K=E[4];var L=E[5];var B=E[6];var N=E[7];var H=undefined;if(E.length>8){H=E[8]}var I=(J||typeof J=="undefined")?"1":"0";var A;if(M=="owner"){if(H!=undefined){if(H=="all"){A=URL_GET_USERFEED+"/"+G+"/owner/"+F+"/"+K+"/all/"+I}else{A=URL_GET_USERFEED+"/"+G+"/owner/"+F+"/"+K+"/animationonly/"+I}}else{A=URL_GET_USERFEED+"/"+G+"/owner/"+F+"/"+K+"/all/"+I}}else{if(M=="others"){if(H!=undefined){if(H=="all"){A=URL_GET_USERFEED+"/"+G+"/others/"+F+"/"+K+"/all/"+I}else{A=URL_GET_USERFEED+"/"+G+"/others/"+F+"/"+K+"/animationonly/"+I}}else{A=URL_GET_USERFEED+"/"+G+"/others/"+F+"/"+K+"/all/"+I}}}new Ajax.Request(A,{method:"post",onSuccess:function(P){var O=P.responseText;fanPagingComplete(O,C,K,L,B,N,G,"userfeed-"+M,F,H)},onFailure:function(){displayFeedback("1Error contacting the server")}})};
